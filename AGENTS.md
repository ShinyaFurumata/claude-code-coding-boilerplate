# Development Guide

## language
- ユーザーへの説明は日本語で行ってください。

## Development
コンテキスト制限の管理:
コンテキストウィンドウは、上限に近づくと自動的に圧縮されます。トークン予算を気にしてタスクを途中で終わらせないでください。予算の限界が近づいていても、常にタスクを完全に完了させてください。

### 開発スタイル/ TDD 原則:
- 機能・UI 開発タスクは原則として TDD（レッド → グリーン → リファクタ）で進めてください。
- 既存のテスト基盤に不足がある場合は、実装に進む前にテストセットアップの改善から着手してください。
- 実装したコードの行数に関わらず、作業を終えるたびに lint とフォーマッターを必ず実行してください。
- ブラウザエラーなど特定の不具合を修正する場合を除いて、ブラウザ環境での動作確認はユーザーが行います。

### タスクの管理/ ExecPlans
複雑な機能実装や大規模なリファクタリングに取り組む際は、設計から実装完了まで `.agents/codex/PLANS.md` に記載されている ExecPlan の手法を使用してください。作成した ExecPlan は `.agents/codex/ExecPlans/` ディレクトリに保存し、将来の参照や再利用を可能にしてください。

### Tools
- パッケージマネージャ: bun
- リンター・フォーマッター: biome 

## Documents
### コードベース内:
プロジェクトを円滑に進めるためのドキュメント群は`.agents/docs/`のディレクトリ群で管理してください。
これは更新され続ける文書であり、各作業完了後、必要に応じて更新し、常に現実を反映した状態を保ってください。
- `ARCHITECTURE.md`は、このプロジェクトの全体像を俯瞰するための中核的なドキュメントです。
- `Libraries.md` を確認し、導入後は利用中のライブラリ一覧に追記

### ライブラリ・外部API:
コード生成、セットアップや構成手順、あるいはライブラリ/API のドキュメントが必要な場合は、常に Context7 を使用してください。つまり、私が明示的に頼まなくても、Context7 MCP ツールを自動的に使用してライブラリ ID を解決し、ライブラリのドキュメントを取得する必要があるということです。
package.json を確認し、該当バージョンのドキュメントを正確に参照することも心がけてください。

## MCP Servers
### Research, Document
Context 7:
ライブラリ/外部APIのドキュメントを読み取るときに使います。

### Design
- **shadcn**： UI コンポーネントを迅速に生成する際、または shadcn/ui の設計思想に沿ったパターンを確認する際に呼び出す。
- **motion+**: コンポーネントにアニメーションを追加する際に呼び出す。
- **ai-elements**： 既存の Vercel の AI Elements に登録されているコンポーネントの情報調査、レイアウト構築やスタイル実装に関する情報取得時に利用してください。

### Browser use
- **next-devtools**： Next.js の関する実装をコードベースから直接調査・補助する際に使用してください。playwright MCPと併用し、実際にブラウザ操作をしながら、`next dev` で実行中のアプリケーションに接続することができます。ルーティングやサーバーアクションの解析を行う場合に利用してください。また、Next.js の最新ドキュメントを確認することもできます。Context7で不十分な場合はこちらを利用してください。
- **playwright**： UI を視覚的に比較・評価する場合に利用。スクリーンショット（要素単位、フルページ）を撮影し、現在の UI/UX を評価するときに利用してください。必要に応じて PC サイズ、SP サイズでの表示確認にも利用できます。
- **chrome-devtools**: ブラウザ上で再現するバグや、パフォーマンス・ネットワーク・コンソールに関する問題を調査する際に利用してください。
ブラウザを使う時の注意点: 
- bun run dev等の開発サーバーを立ち上げる前に、現在の開発サーバー状況を確認してください。既に立ち上がっている場合は、そのportを利用してください。
- 取得した成果物がある場合は、(スクリーンショット・ログ)は `.agents/tmp` に保存し、完了報告で保存先パスを必ず共有してください
- 開発サーバーの起動ログと PID を `.agents/tmp` に記録し、作業終了時にプロセスと利用したブラウザを確実に停止してください

## Project design rules
- 使用フォント: Noto Sans JP
- ブランドカラー: 未指定
- 避けるパターン: 未指定
shadcn, vercel ai elements(pre-built components for AI feature) motion,を利用することで、大幅に実装を効率化することができるので、積極的に活用してください。
